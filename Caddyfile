# Admin Panel (Svelte SPA) + Admin API
https://admin.sibgpt.app {
  root * /srv/ui
  encode gzip zstd

  # Admin API (session-protected)
  handle /api/* {
    reverse_proxy app:8080
  }

  # Grafana under subpath /monitor (optional, but recommended)
  @monitorRoot path /monitor
  handle @monitorRoot {
    redir /monitor/ 301
  }
  handle /monitor/* {
    reverse_proxy grafana:3000
  }

  # SPA fallback
  handle {
    try_files {path} /index.html
    file_server
  }
}

# Payment result SPA + Payment verify API
https://payment.sibgpt.app {
  root * /srv/ui
  encode gzip zstd

  # Payment verify endpoint (server â†’ ZarinPal)
  handle /api/* {
    reverse_proxy app:8080
  }

  # SPA fallback
  handle {
    try_files {path} /index.html
    file_server
  }
}