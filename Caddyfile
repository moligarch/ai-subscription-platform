{
  auto_https off
}

# Admin site (static files) + API proxy
http://admin.localdev {
  root * /srv/admin-ui
  encode gzip zstd

  # Proxy API calls to backend service (preserve path)
  handle /api/* {
    reverse_proxy app:8080
  }

  # Serve SPA and fallback to index.html for client-side routing
  handle {
    try_files {path} /index.html
    file_server
  }
}

# Grafana
http://grafana.localdev {
  reverse_proxy grafana:3000
}